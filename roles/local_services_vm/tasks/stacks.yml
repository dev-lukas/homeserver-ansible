---
# Deploy Docker Compose stacks for all services

# Include individual service configurations
- name: Deploy BentoPDF
  ansible.builtin.include_tasks: services/bentopdf.yml

- name: Deploy VERT
  ansible.builtin.include_tasks: services/vert.yml

- name: Deploy Mealie
  ansible.builtin.include_tasks: services/mealie.yml

- name: Deploy Homepage
  ansible.builtin.include_tasks: services/homepage.yml

# Verification tasks
- name: Wait for services to start
  ansible.builtin.pause:
    seconds: 15

- name: Verify all containers are running
  ansible.builtin.command:
    cmd: docker ps --format 'table {{"{{"}}.Names{{"}}"}}\t{{"{{"}}.Status{{"}}"}}\t{{"{{"}}.Ports{{"}}"}}'
  register: docker_ps
  changed_when: false

- name: Display running containers
  ansible.builtin.debug:
    msg: "{{ docker_ps.stdout_lines }}"
